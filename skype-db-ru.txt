# ОБЩЕЕ
# База данных Skype хранится в AppData/Roaming/Skype/[login]/main.db.
# Она в формате SQLite.
# В ней таблицы:
#   Contacts - все контакты, включая собственный и любые упоминающиеся в чатах.
#   Conversations - по одному на каждый контакт, с которым переписывался + по одному на каждый GroupChat, в котором участвовал.
#   Messages - все сообщения в базе. У каждого указан:
#     conv_id -> conversation, для удостоверения в этом сделан assert_no_convoless_messages()
#     author+from_dispname: кто его написал.
#     timestamp и guid.
#   Всё остальное в messages бывает от случая к случаю:
#     partner_name: отсутствует в любых формах групповой рассылки и ещё иногда.
#     identities: перечисляет адресатов операции, есть не всегда
#     chatname: имя разговора, см. ниже. Есть всегда, но РАЗНОЕ.
# Таким образом для экспорта всех логов достаточно перебрать Conversations и по каждой экспортировать messages в порядке timestamp.

# РАЗГОВОРЫ
# Skype группирует сообщения в разговоры по некоторым своим соображениям. Разговор определяется его ID:
#   #CreatorId/$PartnerId;$ChatUniqueId    для прямых чатов
#   #CreatorId/$ChatUniqueId               для групповых чатов 
#   код:комнаты@thread.skype               для групповых чатов, имеющих уникальный ID такого вида
# Разговор, к которому относится сообщение, указан в chatname.
# Разговоры представляют собой избыточную информацию, они только группируют сообщения. Адресата или комнату сообщения можно однозначно
# восстановить по conv_id.
# По некоторым из разговоров внесены записи с дополнительной информацией в таблицу Chats, но далеко не по всем. Когда в качестве chatname
# указан id группового чата, информацию по нему всегда можно найти в conversations.

# CHATSYNC
# Кроме main.db у Скайпа есть ещё база в собственном формате, называется chatsync. Сложно точно сказать, что в ней есть дополнительно.
# Во всяком случае, там хранятся все версии сообщения, если его редактировали. Возможно так, часть сообщений выгружается туда
# и в main.db отсутствует (есть сообщения об этом, но непроверенные).
# Так или иначе, полезно бы её читать, но это геморрой.
# Ссылки на db-файлы есть в Chats/db_path (и, возможно, conv_dbid).
# То есть, для получения информации из db-файлов есть стратегии:
#  - Перебрать все chats, и загрузить все соотв. db-файлы
#  - Просто загрузить все db-файлы!
#  - Когда нужны версии конкретной записи, посмотреть по ней chatname, и загрузить только этот db-файл.
# Всё это пока оставляю на потом.
# Чтение chatsync: см. также https://github.com/konstantint/skype-chatsync-reader